################################################################################
#                                                                              #
#                         Tracer Application ReadMe                            #
#                                                                              #
################################################################################

Description
===========
The tracer application is a graphical means of displaying trace point time 
stamps generated by the PkTrace class. 

A trace must consist of two sets of data, a previous and a post set. The 
previous set provide positive state changes (eg. Entry point to a function) and 
the post set provides negative state changes (eg. Exit point from a function). 
Therefore it is possible to see how long a function call took to complete by 
plotting this data. 

Two styles of trace are available, Flat line and vertical.

A flat line trace displays points when the state of the trace is greater than
zero, ie. Between two previous and post time stamps. All points are on one 
y-axis, states of zero are not plotted.

A vertical line trace raises the height of a line when the state of the trace 
increases  and falls when the state decreases. It is possible to obtain traces
with state other than 0 and 1.

Usage 
=====
$TRACER_PATH/tracer [-f Filename] [-l Filename]

Where $TRACER_PATH is the path to the tracer application directory

Flags and switches
==================
All switches and flags are optional

-f Filename  The trace file that contains the data to be viewed

-l Filename  The file containing the saved group data.

Environment variables
=====================
The following environment variable will set the resource colours for the
tracer application. It will work without the variable but will not look so
pretty.

Under ksh:
export XENVIRONMENT=$TRACER_PATH/tracer.res

Under csh:
setenv XENVIRONMENT $TRACER_PATH/tracer.res

Where $TRACER_PATH is the path to the tracer application directory

On start up
===========
If no -l or -f value have been used the application will start with no 
initialization.

If the -f value is set on opening the Create Group screen the Filename provided
will be selected and ready for regular expression input. 

If a value for both the -f and -l switch are provided the application will
automatically load the Trace run file and a set of traces for all the groups
in the -l group data file.

Conventions used in this document
=================================
It is assumed a three button mouse is being used, the following is the mouse
button convention

Button1 - Left   button
Button2 - Middle button
Button3 - Right  button

Creating a set of traces
========================
Tracer creates groups of trace results using regular expressions. Each trace
viewed on screen must contain a pair of time stamp data, a previous and post 
set. 

To create a group of traces:-

1. Click Button 1 in the "Trace Control Area" of the tracer 
   application window, the Create Trace Set dialogue box will appear.

2. The top window is the trace file selection area. Select the file containing
   the trace points to be displayed.

3. In the "Prev Trace" area enter the regular expression in the text box to 
   specify. As the expression is typed the File List will automatically filter
   and the Poist Trace Area will fill in, it is assumed that the Post Regular
   expression will be derived from the Previous one.

   A facility now exists that allows automatic filling of the Post field.
   Using "Before" in the Prev field will be converted to "After" in the Post.
   Other word conversion mappings will be available in later versions.

4. When satisfied with the previous filter move to the Post file filter text 
   box and edit the expression to obtain your Post file regular expression. The 
   number of files in each list must match.

5. When satisfied with the lists of traces the characteristics of the trace can 
   be modified as follows:
     Set Name         - Assign a meaningful name to the group
     Trace Separation - Distance in pixels between each trace of the group
     Offset           - Distance in pixels from the top of the work area
     Colour           - The colour of the trace on screen
     Graph Style      - Flat-Line: Points on the trace line shown at one height.                                   Points are shown when state is positive.
                        Vertical:  Trace height rises with positive changes
                                   in state, falls with negative. 
                        Points Only: Shows the points of a single trace stream.
                                     Each hit is shown by a + in the drawing 
                                     area. Selecting this style will cause
                                     the Post trace list to be inaccessable.

     Trace Inversion  - (Flat line and Points Only plots) 
                        The trace drawn on screen will be the inverse of the 
                        plot data, i.e. Where trace is high no point will be 
                        shown, and vice versa.

     Contouring      - (Flat line and Points Only plots)
                       Draws a vertical line between traces linking every 
                       fifth hit in the trace. 

6. Press the OK button and traces will appear in the drawing area of the screen.
   A trace is signified by a light blue push button in the Trace Control Area.
   The settings with be retained when pressing OK as it is assumed that the 
   next set created will be similar to the current one.

   Note:- A trace line will not always appear in the drawing area of the screen,
          its points maybe outside the viewing region. To find the trace either
          increase the scale or use the trace option menu to move to the start 
          of a trace.

Working with the trace drawing area
===================================
The trace drawing area is the black rectangle at the centre of the screen where 
the trace lines are displayed.

The display is centred on the "Mid Time" value, indicated by the green label
in the centre of the screen under the drawing area. The Next Hit, Previous Hit,
Goto Start and Goto End functions adjusts the Mid Time value to be the required
time value, the object of this is to keep focus in the centre of the work area.

The time axis of the traces can be altered using the scroll bar at the bottom of
the drawing area.

The vertical axis of the drawing area can be moved using the scroll bar on the
right. The contents of the full virtual drawing area can be seen in the form to
the left of the scroll bar. The slider of the bar indicates the current area in
view.

The slider size represents the duration of the current loaded trace run.

All values in the time readouts represent seconds.

  Action of mouse buttons in the drawing area
  ===========================================
  Button1 - Displays a vertical line at the mouse pointer position indicating
            the trace time at that point. Releasing the button has no effect.
  Button2 - Displays a vertical line at the mouse pointer position indicating
            the trace time at that point, releasing the button sets the mid
            time to the pointer position time.
  Button3 - Initiates the time difference function. Pressing and holding
            Button3 draws a vertical line at the mouse pointer, dragging the
            mouse to the right creates a second vertical line, in the Time
            display form the time difference between the two lines will
            be displayed. This allows the time between two trace points to be
            measured accurately.
 
Working with scales
===================
The current screen scale setting is always displayed in the Current Scale box
towards the bottom of the screen, this value is seconds/fractions of a second
per pixel.

The scale of the screen can be modified in two ways:-
1. Select a specfic scale from the "Scale Selection" toggle buttons ranging 
   from 10-9 seconds to 10 secs.
2. Use the Zoom area.
   The up arrow zooms inwards, ie Decreases the scale.
   The down arrow zooms outwards, ie. Increases the scale.

   The text box sets the factor by which zooming will occur,
   eg. If factor = 2, zooming in will half the scale, zooming out will double
   the scale.

Working with traces
===================
Traces can be manipulated/modified at the group and individual level.

  Trace Groups
  ============
  A trace group can be moved/modified using the group bar/button in the 
  trace control area.

  Group movement
  --------------
  The entire group can be moved by placing the mouse cursor over the group bar 
  and pressing and holding the left mouse button. The group can be dragged and 
  dropped to the new position in the control area.

  Group actions menu
  ------------------
  Place mouse cursor over the group bar, press and hold Button 3. The group
  menu will appear. 

  The top two lines of the menu indicate the regular expressions used to create
  the trace group.

  The following options are available:-
  Delete     - Deletes the entire group
  Save       - Allows the group characteristics to be saved to a group file.
               Selecting this option will display a dialog box to save the group
               data to a file. Groups will be written to a new file or appended
               to existing group data files. To create a new group data file
               type a new name, to append select a file from the file list.
 
  Properties - Displays the group properties dialog box. 
               This dialog displays information about the group and allows
               the colour of the group to be modified.
               The prev text box shows the regular expression for the Previous
               files.
               The post text box shows the regular expression for the Post
               files.
               The Colour pulldown menu show the colour of the group and allows
               a new colour to be selected. Press OK to apply the new colour
               selection to the group.
               The Trace Inversion toggle shows the Inversion state of the group
               and allows a new state to be selected. A Tick indicates the group
               is inverted.
               The Contour toggle shows the contour state of the group
               and allows contouring to be turned on or off. A Tick indicates 
               the group is inverted.

               Press OK to apply any property modifications to the selected 
               group.

  
  Trace Items
  ===========
  An individual trace can be moved/modified using the small button to the 
  right of the group bar.

  Trace movement
  --------------
  The trace can be moved by placing the mouse cursor over the trace button
  and pressing and holding the left mouse button. The group can be dragged and
  dropped to the new position in the control area.

  Trace actions menu
  ------------------
  Place mouse cursor over the trace button, press and hold Button 3. The trace
  item menu will appear. 

  The top two lines of the menu indicate the two trace files used to create
  the trace item.

  The following options are available:-
  Delete     - Deletes the current item
  Make focus - Sets the trace as the focus, Previous and Next Hit will be 
               applied to this trace
  Goto Start - Moves the midtime to the first hit in the current trace
  Goto End   - Moves the midtime to the last hit in the current trace
  Properties - Displays the trace properties dialog box.
               The prev text box shows the trace name of the for the Previous
               component of the trace.
               The post text box shows the trace name of the for the Post
               component of the trace.
               The Colour pulldown menu show the colour of the trace and allows
               a new colour to be selected.
               The Trace Inversion toggle shows the Inversion state of the item
               and allows a new state to be selected. A Tick indicates the item
               is inverted.
               The Graph Style pulldown menu shows the style of the trace and 
               allows new style to be selected.
               The Num Hits(Prev) field shows the number of hits in the Previous
               trace component.
               The Num Hits(Post) field shows the number of hits in the Post
               trace component.

               Press OK to apply any property modifications to the selected 
               item.


Additional Features
===================
By pressing buttons in the bar above the drawing area the following functions 
are accessile:

Create Trace View - Allows a collection of groups to be opened for viewing.
               A dialog is displayed to selected a trace collection file,
               when OK is pressed a second dialog is displayed to chose a 
               saved groups file. All the groups in the file will be loaded
               and displayed on screen.

Save All Groups - All the groups currently displayed in the application will
               be saved to a file. A dialog box is displayed allowing the user
               to enter the filename. If an exisiting file is chosen, the 
               group data will be appended.

Previous Hit - Sets the midtime to the previous time stamp of the current focus
               trace. Effectively moves one hit down the trace line.

Next Hit     - Sets the midtime to the next time stamp of the current focus
               trace. Effectively moves one hit up the trace line.

Export Data  - Allows trace data to be exported to a plotting application or 
               into a file. Pressing this button will enter export mode,
               pressing and holding button 3 in the drawing area will select the
               regions of the traces to be exported, release the button when the
               correct area has been selected. Export mode can be 
               aborted by pressing the "Cancel Export" button (Previously the
               "Export Data" button. 

               After an export period has been selected the Export Data dialog
               will be displayed. This dialog displays the selected time period 
               to export. The traces that may be exported are displayed in the
               lists- select which files are to be exorted from the lists.
               Note: If exporting to a plotting app the files will be
               automatically paired up, if exporting to a file single traces 
               can be selected.

               Export Method:
                 Export to file - Exports the trace data to a file.
                 Export to plot - Exports the trace data to the plotting app.

               File Options (Only when exporting to file):
                 Export all trace points - Exports all the trace data for the
                       traces in the selected list.
                 Export selected trace points - Exports only the trace points
                       that fall within the selected export period.

               File Format Options (Only when exporting to file):
                 Seconds - Export data as seconds since trace run started.
                 LTime   - Export data as nanoseconds since trace run started.
                 Raw     - Export data as file raw data.


Known Bugs
==========


Comments / Problems / Further Info
==================================
Contact Paul Crafts at:

Email:             paul.crafts@virgin.net 
Alternative email: p8crafts@hursley.ibm.com
